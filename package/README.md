stx
===

[ ![Codeship Status for ChartIQ/stx](https://app.codeship.com/projects/bacf17d0-be6e-0134-93cc-0e3850a18122/status?branch=master)](https://app.codeship.com/projects/196292)

- [Overview](#overview)
- [Commands](#commands)
- [Documentation](#documentation)
- [Testing](#testing)
- [Legacy Versions](#legacy-versions)


Overview
--------

This repository contains the charting library, legacy versions, one-off customer implementations and skunkwork projects. For getting started and developer guides, see the [wiki](https://github.com/ChartIQ/stx/wiki).

```
├─ .config.json          # Cached config generated by "npm run umd" command
├─ .release.json         # Config file for the "npm run release" command
├─ Dockerfile            # Headless test environment for Docker
├─ README.md             # You are here
├─ addons.entry.js       # Module entry point for generating "addOns.js" (auto-generated)
├─ ciq.entry.config.json # Config for auto-generating the webpack entry files
├─ chartiq.entry.js      # Module entry point for generating "chartiq.js" (auto-generated)
├─ chartiq-lite.entry.js # Module entry point for generating "chartiq-lite.js" (auto-generated)
├─ components.entry.js   # Module entry point for generating "components.js" (auto-generated)
├─ concat-lib.sh         # Concatenates library files using bash
├─ docs                  # Documentation site files
│   ├─ src               # Documentation source files (tutorials and assets)
│   └─ template          # Templates and stylesheets for the generated jsdoc site
├─ docs-site             # Documentation as generated by "npm run docs:build"
├─ eslint-spec.yaml      # Eslint rules for spec and config files (ES6)
├─ eslint.yaml           # Main (ES5) eslint rule file
├─ gulpfile.js           # Documentation side build scripts
├─ htdocs                # Library source code files
│   ├─ custom            # Customer environment implementations
│   ├─ default           # The library itself, and internal implementations
│   └─ dev               # Proof of concept templates
│       └─ skunkworks    # One off research projects
├─ jshint.js             # Run linters
├─ karma.conf.js         # Karma test runner config
├─ package.json          # Library node scripts (documented below)
├─ quick-build.js        # Concatenates library files using node
├─ sass.sh               # Compile sass files to css
├─ spec                  # Written automated tests
│   ├─ e2e               # End-to-end tests
│   ├─ integration       # Integration tests
│   ├─ performance       # Performance tests
│   └─ unit              # Unit tests
├─ src                   # Build server and quoteFeed files
├─ stylelint.yaml        # Stylelint rules
├─ test.entry.js         # Module entry point for bundling all the unit tests
├─ test-output           # Output for test runners
│   ├─ coverage          # Karma source code coverage report
│   └─ screenshots       # Screenshots generated by wdio tests
├─ verifyUMD.js          # Node script to verify UMD header comments
├─ wdio.conf.js          # End-to-end test runner
└─ webpack.config.js     # Config for launching dev server and building karma test app
```


Commands - `npm` Scripts
------------------------

* List all commands using `npm run`.
* Minimum node version is the [maintenance release](https://github.com/nodejs/Release#release-schedule).
* Minimum npm version is the [lts release](https://www.npmjs.com/package/npm/v/lts).

```sh
npm install			# install all dependencies and devDependencies listed in package.json
npm run concat-lib		# concatenate all bundled files together using bash shell script and copy to output files
npm run concat-lib-node	# concatenate all bundled files together using nodejs script and copy to output files
npm run build			# bundle library files with webpack
npm run docs:build		# build the documentation, written to the docs-site/ folder
npm run docs:watch		# watch *.{js,md,png} source files and rebuild docs
npm run eslint		# lints js files in htdocs/default/js/ and spec/
npm run eslint:fix		# auto-fix errors caught by eslint (use cautiously)
npm run htmlhint		# lints html files in htdocs/default/
npm run jshint		# lints js files (for backwards compatibility)
npm run karma			# run tests required by test.entry.js
npm run karma:watch		# continue to run karma and watch for new/modified tests
npm run release		# create a new version and release
run run scss:ciq		# build htdocs/default/css/chartiq.css
npm run scss:tfc		# build htdocs/default/plugins/tfc/tfc.css
npm run scss:cryptoiq		# build htdocs/default/plugins/cryptoiq/cryptoiq.css
npm run scss:scriptiq		# build htdocs/default/plugins/scriptiq/scriptiq-editor.css
npm run stylelint		# lints sass files in htdocs/default/sass/
npm run test			# run eslint, stylelint, umd and karma
npm run test:ci		# run eslint, stylelint, umd, karma, wdio and docs:build
npm run umd			# lints js files in htdocs/default/js/ for UMD bundle comments
npm run watch			# bundle library files and run local dev server with linter
npm run wdio			# run tests in the spec/e2e/ folder
npm run wdio:spec		# run a specified test in the spec/e2e/ folder (pass as an argument)
npm run wdio:watch		# continue to run wdio and watch for new/modified tests
npm run wdio-perf		# run tests in the spec/performance/ folder
```


Documentation
-------------

- Public documentation can be found at http://documentation.chartiq.com/.
- Git master branch revisions of the deployed documentation can be found at http://docs.chartiq.com/preview/ where they are auto-deployed with every commit.
- For compiling and deploying the docs, see [docs/README.md](docs/README.md).
- For the developer guide to writing documentation, see the wiki's [Documentation Guide](https://github.com/ChartIQ/stx/wiki/Documentation-Guide).

Building
--------

To build the libraries, use the following command:
```sh
npm run concat-lib
```
or
```sh
npm run concat-lib-node
```
If you do not have npm/nodejs installed, but have bash shell, you can run:
```sh
sh concat-lib.sh
```

Testing
-------

For running tests quickly, run:
```sh
npm run test
```

For a full list of commands for running tests, see [commands](#commands).
For a detailed breakdown of testing tools and how to write tests, see [the wiki](https://github.com/ChartIQ/stx/wiki/Testing).

If you don't want to install nodejs, chrome, firefox, and java to run tests, you can install [Docker](https://www.docker.com/what-docker) and run this command to build a docker container test environment:

```sh
# "chartiq-container" is the container name. It can be whatever you want.
docker build -t chartiq-container .
```

And once done building, drop into a shell environment inside of it with this command:
```sh
docker run -ti -v "$PWD/":/app chartiq-container /bin/bash
```



Legacy Versions
---------------

1. For code written prior to February 2014, commits were done only on released
versions of htdocs from modulus folder, and backed up src from
connect.chartiq.com. A best-effort guess was made to link the htdocs with a
compatible src, but it is not necessarily the case that an src/htdocs pair
which exists at the same point in time in the repository actually ran
concurrently in production.
2. For code written after February 2014 but before June 2014, commits were done
only on Terry's htdocs.zip's which were distributed internally.
3. From June 2014 onwards, repository history should reflect all changes and
who authored them.
